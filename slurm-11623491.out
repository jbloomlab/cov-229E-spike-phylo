Running snakemake...
Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 16
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job                                count
-------------------------------  -------
align_protein_sequences                1
all                                    1
ancestral_tree_sequences               1
calculate_variation                    1
check_number_ORFs_found                1
colors                                 1
create_codon_alignment                 1
create_new_references                  1
download_and_process_accessions        1
edit_codon_fasta_headers               1
edit_protein_fasta_headers             1
export_tree                            1
get_codon_sequences                    1
get_protein_sequences                  1
refine_tree_sequences                  1
root_and_remove_outgroup               1
strip_codon_alignment_gaps             1
strip_protein_alignment_gaps           1
traits_tree_sequences                  1
translate_tree_sequences               1
tree_sequences                         1
total                                 21

Select jobs to execute...

[Wed Feb 26 12:17:47 2025]
rule create_new_references:
    input: Configure/Input_Data/HcoV-229E_referance_sequence.gb
    output: Results/spike/spike_reference.gb
    log: Results/Logs/spike/create_new_references.txt
    jobid: 18
    reason: Missing output files: Results/spike/spike_reference.gb
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:17:48 2025]
rule download_and_process_accessions:
    input: Configure/Input_Data/229E_full_accession_list.txt
    output: Results/spike/nucleotide.fasta, Results/spike/metadata.tsv
    log: Results/Logs/spike/download_and_process_accessions.txt
    jobid: 2
    reason: Missing output files: Results/spike/metadata.tsv, Results/spike/nucleotide.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:17:52 2025]
Finished job 18.
1 of 21 steps (5%) done
[Wed Feb 26 12:27:35 2025]
Finished job 2.
2 of 21 steps (10%) done
Select jobs to execute...

[Wed Feb 26 12:27:35 2025]
rule get_protein_sequences:
    input: Results/spike/nucleotide.fasta
    output: Results/spike/ORF_sequences/protein_temp.fasta
    log: Results/Logs/spike/get_protein_sequences.txt
    jobid: 3
    reason: Missing output files: Results/spike/ORF_sequences/protein_temp.fasta; Input files updated by another job: Results/spike/nucleotide.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:27:35 2025]
rule colors:
    input: Configure/Input_Data/color_schemes.tsv, Configure/Input_Data/color_orderings.tsv, Results/spike/metadata.tsv
    output: Results/spike/Trees/colors.tsv
    jobid: 19
    reason: Missing output files: Results/spike/Trees/colors.tsv; Input files updated by another job: Results/spike/metadata.tsv
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:27:35 2025]
rule get_codon_sequences:
    input: Results/spike/nucleotide.fasta
    output: Results/spike/ORF_sequences/codon_temp.fasta
    log: Results/Logs/spike/get_codon_sequences.txt
    jobid: 4
    reason: Missing output files: Results/spike/ORF_sequences/codon_temp.fasta; Input files updated by another job: Results/spike/nucleotide.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:37 2025]
Finished job 3.
3 of 21 steps (14%) done
Select jobs to execute...

[Wed Feb 26 12:27:37 2025]
rule edit_protein_fasta_headers:
    input: Results/spike/ORF_sequences/protein_temp.fasta
    output: Results/spike/ORF_sequences/protein.fasta
    log: Results/Logs/spike/edit_protein_fasta_headers.txt
    jobid: 12
    reason: Missing output files: Results/spike/ORF_sequences/protein.fasta; Input files updated by another job: Results/spike/ORF_sequences/protein_temp.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:37 2025]
Finished job 4.
4 of 21 steps (19%) done
Select jobs to execute...

[Wed Feb 26 12:27:37 2025]
rule check_number_ORFs_found:
    input: Results/spike/nucleotide.fasta, Results/spike/ORF_sequences/protein_temp.fasta, Results/spike/ORF_sequences/codon_temp.fasta
    output: Results/spike/ORF_sequences/ORF_extraction_verification.txt
    jobid: 1
    reason: Missing output files: Results/spike/ORF_sequences/ORF_extraction_verification.txt; Input files updated by another job: Results/spike/ORF_sequences/protein_temp.fasta, Results/spike/ORF_sequences/codon_temp.fasta, Results/spike/nucleotide.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:27:37 2025]
rule edit_codon_fasta_headers:
    input: Results/spike/ORF_sequences/codon_temp.fasta
    output: Results/spike/ORF_sequences/codon.fasta
    log: Results/Logs/spike/edit_codon_fasta_headers.txt
    jobid: 13
    reason: Missing output files: Results/spike/ORF_sequences/codon.fasta; Input files updated by another job: Results/spike/ORF_sequences/codon_temp.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:39 2025]
Finished job 1.
5 of 21 steps (24%) done
[Wed Feb 26 12:27:40 2025]
Finished job 12.
6 of 21 steps (29%) done
Select jobs to execute...

[Wed Feb 26 12:27:40 2025]
rule align_protein_sequences:
    input: Results/spike/ORF_sequences/protein.fasta
    output: Results/spike/Alignments/protein.fasta
    log: Results/Logs/spike/align_protein_sequences.txt
    jobid: 11
    reason: Missing output files: Results/spike/Alignments/protein.fasta; Input files updated by another job: Results/spike/ORF_sequences/protein.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:40 2025]
Finished job 13.
7 of 21 steps (33%) done
[Wed Feb 26 12:27:41 2025]
Finished job 19.
8 of 21 steps (38%) done
[Wed Feb 26 12:27:46 2025]
Finished job 11.
9 of 21 steps (43%) done
Select jobs to execute...

[Wed Feb 26 12:27:46 2025]
rule create_codon_alignment:
    input: Results/spike/Alignments/protein.fasta, Results/spike/ORF_sequences/codon.fasta
    output: Results/spike/Alignments/codon.fasta
    log: Results/Logs/spike/create_codon_alignment.txt
    jobid: 10
    reason: Missing output files: Results/spike/Alignments/codon.fasta; Input files updated by another job: Results/spike/ORF_sequences/codon.fasta, Results/spike/Alignments/protein.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:46 2025]
rule strip_protein_alignment_gaps:
    input: Results/spike/Alignments/protein.fasta
    output: Results/spike/Alignments/protein_ungapped.fasta
    log: Results/Logs/spike/strip_protein_alignment_gaps.txt
    jobid: 14
    reason: Missing output files: Results/spike/Alignments/protein_ungapped.fasta; Input files updated by another job: Results/spike/Alignments/protein.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:49 2025]
Finished job 14.
10 of 21 steps (48%) done
[Wed Feb 26 12:27:49 2025]
Finished job 10.
11 of 21 steps (52%) done
Select jobs to execute...

[Wed Feb 26 12:27:49 2025]
rule strip_codon_alignment_gaps:
    input: Results/spike/Alignments/codon.fasta
    output: Results/spike/Alignments/codon_ungapped.fasta
    log: Results/Logs/spike/strip_codon_alignment_gaps.txt
    jobid: 9
    reason: Missing output files: Results/spike/Alignments/codon_ungapped.fasta; Input files updated by another job: Results/spike/Alignments/codon.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:27:52 2025]
Finished job 9.
12 of 21 steps (57%) done
Select jobs to execute...

[Wed Feb 26 12:27:52 2025]
rule tree_sequences:
    input: Results/spike/Alignments/codon_ungapped.fasta
    output: Results/spike/Trees/tree_raw.nwk
    log: Results/Logs/spike/tree_sequences.txt
    jobid: 8
    reason: Missing output files: Results/spike/Trees/tree_raw.nwk; Input files updated by another job: Results/spike/Alignments/codon_ungapped.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:28:24 2025]
Finished job 8.
13 of 21 steps (62%) done
Select jobs to execute...

[Wed Feb 26 12:28:24 2025]
rule root_and_remove_outgroup:
    input: Results/spike/Trees/tree_raw.nwk, Results/spike/Alignments/protein_ungapped.fasta, Results/spike/Alignments/codon_ungapped.fasta
    output: Results/spike/Trees/tree_no_outgroup.nwk, Results/spike/Alignments/protein_ungapped_no_outgroup.fasta, Results/spike/Alignments/codon_ungapped_no_outgroup.fasta
    log: Results/Logs/spike/root_and_remove_outgroup.txt
    jobid: 7
    reason: Missing output files: Results/spike/Trees/tree_no_outgroup.nwk, Results/spike/Alignments/protein_ungapped_no_outgroup.fasta, Results/spike/Alignments/codon_ungapped_no_outgroup.fasta; Input files updated by another job: Results/spike/Alignments/codon_ungapped.fasta, Results/spike/Alignments/protein_ungapped.fasta, Results/spike/Trees/tree_raw.nwk
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:28:28 2025]
Finished job 7.
14 of 21 steps (67%) done
Select jobs to execute...

[Wed Feb 26 12:28:28 2025]
rule refine_tree_sequences:
    input: Results/spike/Alignments/codon_ungapped_no_outgroup.fasta, Results/spike/Trees/tree_no_outgroup.nwk, Results/spike/metadata.tsv
    output: Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_branch_lengths.json
    log: Results/Logs/spike/refine_tree_sequences.txt
    jobid: 6
    reason: Missing output files: Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_branch_lengths.json; Input files updated by another job: Results/spike/Trees/tree_no_outgroup.nwk, Results/spike/metadata.tsv, Results/spike/Alignments/codon_ungapped_no_outgroup.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:28:28 2025]
rule calculate_variation:
    input: Results/spike/Alignments/protein_ungapped_no_outgroup.fasta
    output: Results/spike/Alignments/spike_natural_variation.csv
    jobid: 20
    reason: Missing output files: Results/spike/Alignments/spike_natural_variation.csv; Input files updated by another job: Results/spike/Alignments/protein_ungapped_no_outgroup.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

/home/sharari/miniforge3/envs/evo_jump/lib/python3.11/site-packages/pandas/core/arraylike.py:402: RuntimeWarning: divide by zero encountered in log
  result = getattr(ufunc, method)(*inputs, **kwargs)
[Wed Feb 26 12:28:42 2025]
Finished job 20.
15 of 21 steps (71%) done
[Wed Feb 26 12:28:45 2025]
Finished job 6.
16 of 21 steps (76%) done
Select jobs to execute...

[Wed Feb 26 12:28:45 2025]
rule ancestral_tree_sequences:
    input: Results/spike/Trees/tree.nwk, Results/spike/Alignments/codon_ungapped_no_outgroup.fasta
    output: Results/spike/Trees/tree_muts.json
    log: Results/Logs/spike/ancestral_tree_sequences.txt
    jobid: 16
    reason: Missing output files: Results/spike/Trees/tree_muts.json; Input files updated by another job: Results/spike/Trees/tree.nwk, Results/spike/Alignments/codon_ungapped_no_outgroup.fasta
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491


[Wed Feb 26 12:28:45 2025]
rule traits_tree_sequences:
    input: Results/spike/Trees/tree.nwk, Results/spike/metadata.tsv
    output: Results/spike/Trees/tree_traits.json
    log: Results/Logs/spike/traits_tree_sequences.txt
    jobid: 15
    reason: Missing output files: Results/spike/Trees/tree_traits.json; Input files updated by another job: Results/spike/Trees/tree.nwk, Results/spike/metadata.tsv
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:29:02 2025]
Finished job 16.
17 of 21 steps (81%) done
Select jobs to execute...

[Wed Feb 26 12:29:02 2025]
rule translate_tree_sequences:
    input: Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json, Results/spike/spike_reference.gb
    output: Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta, Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
    log: Results/Logs/spike/translate_tree_sequences.txt
    jobid: 17
    reason: Missing output files: Results/spike/Trees/tree_aa_muts.json; Input files updated by another job: Results/spike/spike_reference.gb, Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

[Wed Feb 26 12:29:03 2025]
Finished job 15.
18 of 21 steps (86%) done
Waiting at most 60 seconds for missing files.
MissingOutputException in rule translate_tree_sequences in file /fh/fast/bloom_j/computational_notebooks/sharari/2025/HcoV_229E_phylo_analysis/Rules/augur_processing.smk, line 119:
Job 17  completed successfully, but some output files are missing. Missing files after 60 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
Removing output files of failed job translate_tree_sequences since they might be corrupted:
Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta
Trying to restart job 17.
Select jobs to execute...

[Wed Feb 26 12:30:15 2025]
rule translate_tree_sequences:
    input: Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json, Results/spike/spike_reference.gb
    output: Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta, Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
    log: Results/Logs/spike/translate_tree_sequences.txt
    jobid: 17
    reason: Missing output files: Results/spike/Trees/tree_aa_muts.json; Input files updated by another job: Results/spike/spike_reference.gb, Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

Waiting at most 60 seconds for missing files.
MissingOutputException in rule translate_tree_sequences in file /fh/fast/bloom_j/computational_notebooks/sharari/2025/HcoV_229E_phylo_analysis/Rules/augur_processing.smk, line 119:
Job 17  completed successfully, but some output files are missing. Missing files after 60 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
Removing output files of failed job translate_tree_sequences since they might be corrupted:
Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta
Trying to restart job 17.
Select jobs to execute...

[Wed Feb 26 12:31:36 2025]
rule translate_tree_sequences:
    input: Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json, Results/spike/spike_reference.gb
    output: Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta, Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
    log: Results/Logs/spike/translate_tree_sequences.txt
    jobid: 17
    reason: Missing output files: Results/spike/Trees/tree_aa_muts.json; Input files updated by another job: Results/spike/spike_reference.gb, Results/spike/Trees/tree.nwk, Results/spike/Trees/tree_muts.json
    wildcards: gene=spike
    resources: tmpdir=/loc/scratch/11623491

Waiting at most 60 seconds for missing files.
MissingOutputException in rule translate_tree_sequences in file /fh/fast/bloom_j/computational_notebooks/sharari/2025/HcoV_229E_phylo_analysis/Rules/augur_processing.smk, line 119:
Job 17  completed successfully, but some output files are missing. Missing files after 60 seconds. This might be due to filesystem latency. If that is the case, consider to increase the wait time with --latency-wait:
Results/spike/Augur_AA_Alignements/spike_ectodomain.fasta
Removing output files of failed job translate_tree_sequences since they might be corrupted:
Results/spike/Trees/tree_aa_muts.json, Results/spike/Augur_AA_Alignements/spike_full_length.fasta
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2025-02-26T121724.023002.snakemake.log
